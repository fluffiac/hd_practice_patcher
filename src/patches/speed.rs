use crate::patch;

/// Control the game simulation speed using the replay speed controls
/// anywhere in the game, including while in a run.
pub type SpeedPatch = (
    // resetters change the simulation speed multiplier to 1 when 
    // entering the menu and dagger lobby. these patches disable
    // those.
    (DisableResetterOne, DisableResetterTwo, DisableResetterThree),
    // the speed increment and decrement buttons multiply the 
    // simulation speedby 0.5 and 2.0 respectively. these patches 
    // change that to constant addition/subtraction of 0.05
    (ConstantSpeedIncrement, ConstantSpeedDecrement),
    // by default, the simulation speed buttons cannot be used
    // in certain situations. these patches disable those checks
    // so that they can be used at all times.
    (EnableSlowerBind, EnableFasterBind, EnableResetBind),
);

patch!(
    DisableResetterOne,
    0x007BD7,
    [0xC7, 0x82, 0x54, 0x01, 0x00, 0x00, 0x00, 0x00, 0x80, 0x3F, 0x48, 0x8D, 0x8A, 0xB4, 0x05],
    [0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x48, 0x8D, 0x8A, 0xB4, 0x05]
);

patch!(
    DisableResetterTwo,
    0x06699C,
    [0xC7, 0x81, 0x54, 0x01, 0x00, 0x00, 0x00, 0x00, 0x80, 0x3F, 0x48, 0x81, 0xC1, 0xB4, 0x05],
    [0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x48, 0x81, 0xC1, 0xB4, 0x05]
);

patch!(
    DisableResetterThree,
    0x068D61,
    [0x41, 0xC7, 0x81, 0x54, 0x01, 0x00, 0x00, 0x00, 0x00, 0x80, 0x3F, 0x49, 0x8D, 0x89, 0xB4, 0x05],
    [0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x49, 0x8D, 0x89, 0xB4, 0x05]
);

patch!(
    ConstantSpeedIncrement,
    0x072C57,
    [0xF3, 0x0F, 0x59, 0x05, 0xFD, 0x1A, 0x30, 0x00],
    [0xF3, 0x0F, 0x5C, 0x05, 0x48, 0xD1, 0xF9, 0xFF]
);

patch!(
    ConstantSpeedDecrement,
    0x072CA6,
    [0xF3, 0x0F, 0x58, 0xC0, 0xF3, 0x0F, 0x10, 0x0D, 0x06, 0x1F, 0x30, 0x00, 0xF3, 0x0F, 0x5D, 0xC8],
    [0xF3, 0x0F, 0x58, 0x05, 0xF9, 0xD0, 0xF9, 0xFF, 0xF3, 0x0F, 0x10, 0xC8, 0x90, 0x90, 0x90, 0x90]
);

patch!(
    EnableSlowerBind,
    0x072C31,
    [0x75, 0x40, 0x80, 0x7A, 0x58, 0x00, 0x75, 0x09, 0x80, 0xBA, 0x65, 0x03, 0x00, 0x00, 0x00, 0x74, 0x31],
    [0x75, 0x40, 0x80, 0x7A, 0x58, 0x00, 0x90, 0x90, 0x80, 0xBA, 0x65, 0x03, 0x00, 0x00, 0x00, 0x90, 0x90]
);

patch!(
    EnableFasterBind,
    0x072C80,
    [0x75, 0x3C, 0x80, 0x7A, 0x58, 0x00, 0x75, 0x09, 0x80, 0xBA, 0x65, 0x03, 0x00, 0x00, 0x00, 0x74, 0x2D],
    [0x75, 0x3C, 0x80, 0x7A, 0x58, 0x00, 0x90, 0x90, 0x80, 0xBA, 0x65, 0x03, 0x00, 0x00, 0x00, 0x90, 0x90]
);

patch!(
    EnableResetBind,
    0x072CD3,
    [0x7E, 0x23, 0x80, 0x7A, 0x58, 0x00, 0x75, 0x09, 0x80, 0xBA, 0x65, 0x03, 0x00, 0x00, 0x00, 0x74, 0x14],
    [0x7E, 0x23, 0x80, 0x7A, 0x58, 0x00, 0x90, 0x90, 0x80, 0xBA, 0x65, 0x03, 0x00, 0x00, 0x00, 0x90, 0x90]
);
